<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
    <title>Recorder</title>
    <link rel="stylesheet" type="text/css" href="style.css"/>
</head>
<body>
<script type="text/javascript" src="recorder.js"></script>
<script>
    /**
     * 倒计时
     */
    function timecode(ms) {
        var hms = {
            h: Math.floor(ms / (60 * 60 * 1000)),
            m: Math.floor((ms / 60000) % 60),
            s: Math.floor((ms / 1000) % 60)
        };
        var tc = [];

        if (hms.h > 0) {
            tc.push(hms.h);
        }

        tc.push((hms.m < 10 && hms.h > 0 ? "0" + hms.m : hms.m));
        tc.push((hms.s < 10 ? "0" + hms.s : hms.s));

        return tc.join(':');
    }


    /**
     * 记录一下啊，这个是初始化
     */
    Recorder.initialize({
        swfSrc: "recorder.swf"
    });

    /**
     * 记录录音
     */
    function record() {
        Recorder.record({
            start: function () {
                console.log("recording starts now. press stop when youre done. and then play or upload if you want.");
            },
            progress: function (milliseconds) {
                document.getElementById("time").innerHTML = timecode(milliseconds);
            }
        });
    }

    /**
     * 播放录音
     */
    function play() {
        Recorder.stop();
        Recorder.play({
            progress: function (milliseconds) {
                document.getElementById("time").innerHTML = timecode(milliseconds);
            }
        });
    }

    /**
     * 结束录音
     */
    function stop() {
        Recorder.stop();
    }

    /**
     * 上传到服务器上
     */
    function upload() {
        Recorder.upload({
            url: "https://example.com/upload",
            audioParam: "your_file",
            success: function () {
                alert("your file was uploaded!");
            }
        });
    }
</script>

<div id="wrapper">
    <h1><a href="http://github.com/jwagener/recorder">Recorder Example</a></h1>
    <p>
        This is a very basic example for the Recorder.js.
        Checkout <a href="http://github.com/jwagener/recorder">GitHub</a> for details and have a look at the source for
        this file.
        Start by clicking record:
    </p>
    <div>
        <a href="javascript:record()" id="record">Record</a>
        <a href="javascript:play()" id="play">Play</a>
        <a href="javascript:stop()" id="stop">Stop</a>
        <a href="javascript:upload()" id="upload">Upload (faked)</a>
    </div>

    <span id="time">0:00</span>
</div>
</body>
</html>
